<UserControl x:Class="Vexa.Controls.WaveformControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="120" d:DesignWidth="800"
             Background="White"
             ClipToBounds="True">
    <Grid x:Name="MainGrid" MouseMove="OnMouseMove" MouseLeave="OnMouseLeave" MouseLeftButtonDown="OnMouseDown">
        <Canvas x:Name="WaveformCanvas" Background="Transparent" />
        <Border Height="25" VerticalAlignment="Top" Background="#F8F8F8" BorderBrush="#E0E0E0" BorderThickness="0,0,0,1">
            <Canvas x:Name="RulerCanvas" Background="Transparent" />
        </Border>
        
        <!-- Hover Overlay Canvas (Absolute positioning for performance) -->
        <Canvas IsHitTestVisible="False" Panel.ZIndex="15">
            <!-- Hover Marker Line -->
            <Rectangle x:Name="HoverLine" Width="1" Fill="#994A90E2" Height="{Binding ActualHeight, ElementName=MainGrid}" Visibility="Collapsed">
                <Rectangle.RenderTransform>
                    <TranslateTransform x:Name="HoverLineTransform" />
                </Rectangle.RenderTransform>
            </Rectangle>

            <!-- Pill-shaped Tooltip -->
            <Border x:Name="HoverTooltip" 
                    Visibility="Collapsed" 
                    Background="Black" 
                    CornerRadius="12" 
                    Padding="10,4" 
                    MinWidth="60"
                    IsHitTestVisible="False">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="5" ShadowDepth="1" Opacity="0.4" />
                </Border.Effect>
                <Border.RenderTransform>
                    <TranslateTransform x:Name="HoverTooltipTransform" />
                </Border.RenderTransform>
                <TextBlock x:Name="HoverTimeText" 
                           Foreground="White" 
                           FontSize="12" 
                           FontWeight="Bold" 
                           HorizontalAlignment="Center" />
            </Border>
        </Canvas>

        <!-- Playhead -->
        <Rectangle x:Name="Playhead" Width="2" Fill="Red" HorizontalAlignment="Left" Visibility="Collapsed" IsHitTestVisible="False" Panel.ZIndex="10" />
    </Grid>
</UserControl>
